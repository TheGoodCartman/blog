<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.283">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The KingOli Blog - Top Spin 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../k-typewriter.png" rel="icon" type="image/png">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../k-typewriter.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">The KingOli Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TheGoodCartman" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Top Spin 4</h1>
  <div class="quarto-categories">
    <div class="quarto-category">gespielt</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">24.04.2011 21:52</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Ich spiele die Top-Spin-Serie seit dem ersten Teil. Anfangs noch auf dem PC, aber mit Gamepad, seit <a href="../../../../2009/04/20/minimalismus-und-details/">Teil 3 nun auf der Playstation</a>. Deshalb kann ich sagen, dass die vierte Auflage definitiv das realistischste Gameplay aller Teile hat, denn endlich ist es möglich, sowohl das von Rafael Nadal perfektionierte kraftvolle Top-Spin-Winkel-Tennis zu spielen als auch das kaum noch vertretene Serve-and-Volley im Stile von Boris Becker und Patrick Rafter. Die letzteren Beiden gehören zu der illustren Reihe von acht ehemaligen Weltklassespielern, die neben zehn aktuellen Spielern den Weg in <em>Top Spin 4</em> geschafft haben - darunter mit Nadal, Djokovic, Federer und Murray die momentanen Top 4 der Weltrangliste. Alle sind in ihren Bewegungsabläufen und Spielweisen sehr realistisch umgesetzt, allein bei den Gesichtern kommen manchmal Zweifel auf. Die lizensierten Frauen sind nicht so breit wie die Herrenkonkurrenz aufgestellt, nur sieben aktuelle Spielerinnen (u.a. Wozniaki und Serena Williams) stehen zur Auswahl.</p>
<p>Die Steuerung ist etwas einfacher geworden, da Lobs wieder auf einer einzelnen Taste liegen und Stoppbälle nur die Hinzunahme einer Schultertaste erfordern. Doch so einfach diese zu erlernen sind, so schwer sind sie zu meistern. Nur exaktes Timing (wenn der Spieler zum Schlag ausholt) führt zu guten Schlägen, bei zu frühem oder zu späten Drücken der Schlagtaste(n) geht der Ball gerne ins Aus und nicht wie gewollt kurz hinter die Netzkante oder vor die Grundlinie. Dafür sind Crossschläge und damit extreme Winkel endlich möglich, per Schultertaste auch Inside-Outs, die sich jedoch kaum von normalen Top-Spin-Cross-Schlägen unterscheiden. Der Aufschlag wird weiter über den rechten Analogstick ausgeführt und führt zu einer recht realistischen Quote von Fehlern und Assen, da letztere von Winkel und Schlagstärke abhängen und ein gewisses Risiko erfordern - Asse am laufenden Band sind so nicht möglich.</p>
<p>Beim Stellungsspiel unterstützt <em>Top Spin 4</em> weiterhin den Spieler, da dieser mit demselben Analogstick, mit dem der Spieler im Spielfeld bewegt wird, auch die Zielrichtung des Schlages vorgibt. Ab einem bestimmten Zeitpunkt übernimmt also das Spiel die finale Ausrichtung, und der Schlag muss “nur” noch getimt werden, damit er auch gefährlich wird. Dabei hatte ich zum ersten Mal bei einem Tennisvideospiel das Gefühl, dass Gameplay und Platzgröße genau harmonieren und nicht der Spieler Bälle auslässt, obwohl er sich physisch eigentlich in Reichweite befindet. Lobs haben genau die richtige Höhe, und wenn nicht richtig getimt dann werden sie durch Schmetterbälle beantwortet. Zudem sind die Unterschiede der einzelnen Schlagvarianten (Top Spin, Slice, normaler Schlag) deutlich auszumachen, da die Gegner entsprechend reagieren. Slices sind aus dem Lauf besser zu kontrollieren und ermöglichen durch ihre längere Flugzeit, dass sich der eigene Spieler wieder auf dem Platz orientieren kann. Top Spins dagegen treiben mit der richtigen Länge den Gegner aus dem Feld - wenn ein Tennisspiel jemals den Namen Simulation verdiente, dann <em>Top Spin 4</em>, das damit endlich das erste <em>Tennis Master Series</em> vom Thron stößt.</p>
<p>Grafisch hat sich seit dem Vorgänger einiges getan. Gerade der Schattenwurf und die Darstellung der Courts (die Zuschauer sind endlich keine Bitmaps mehr, die Kamerafahrten über den Platz sind ruckelfrei) wurden sichtbar verbessert, wenngleich die Kleidungsstücke trotz realistisch wachsender Schweißflecken seltsam unbewegt am Körper hängen. Mit der Grafik nicht mithalten kann die Präsentation des Spiels. Dies fängt an bei den langweiligen Menüs, die alle einen bezierähnlichen blauen Hintergrund aufweisen und dessen drei Musikstücke schnell langweilen, und setzt sich fort bei den Spielfeldern. So wurde zwar der Einmarsch der Spieler ebenso wie deren Pausen zwischen den Spielen animiert, aber ansonsten passiert nichts auf dem Feld. Kein Schiedsrichter steigt von seinem Podest, kein Balljunge rennt nach dem Ball, kein Hawk-Eye darf angefordert werden und wenn ein Turnier gewonnen wird, dann gibt es keine Pokalüberreichung oder Siegerehrung.</p>
<p>Dafür darf man sich als Spieler schnell an Ladebildschirme gewöhnen, vor denen man viel Zeit verbringt. Schon nach dem leeren Startbildschirm, welchen man wie bei jedem PS3-Game erst einmal mit Start bestätigen muss, lädt das Spiel gefühlte 15s, weil man danach nämlich nicht das Menü erreicht, sondern einen Ballmaschinenmodus, in dem man üben kann. Dies soll vermutlich den Torschussmodus von FIFA nacheifern, ohne ihn verstanden zu haben. Denn bei FIFA kann man Torschüsse üben, während das Spiel lädt - bei <em>Top Spin 4</em> lädt das Spiel den Ballmaschinenmodus, obwohl man doch eigentlich sofort ins Menü will. Und auch ansonsten legt das Spiel fast zwischen jedem Menüpunkt eine Ladepause ein. Starten des Turniers - Ladepause. Starten des ersten Spiels - Ladepause. Spielen der nächsten Runde - Ladepause. Manchmal heißt das Laden auch Speichern, obwohl gar nicht gespeichert wird. So ist mir das Spiel einmal abgestürzt und ich wurde zum letzten Speicherpunkt (drei Turniere vorher) zurückgeworfen. In Relation zu den Spielen hält sich die Ladezeit ingesamt in Grenzen, aber ein wenig Vorladen (innerhalb eines Turniers ändert sich der Court z.B. nicht) und ein schnelles Vorankommen in den Menüs sollte eigentlich drin sein.</p>
<p>Bei den lizensierten Turnieren sind fast alle bekannten Namen dabei (es fehlt leider weiterhin Wimbledon) und so gut deren Courts den realen Vorbildern nachempfunden wurden, so schwach ist die Darstellung in den Menüs. Ein Logo des Turniers fliegt vor dem schon erwähnten blauen Hintergrund und bei einem Sieg ist auf demselben Bildschirm ein <em>Glückwunsch, sie waren erfolgreich!</em> zu lesen. Die <em>Top-Spin-Akademie</em>, in der die Grundlagen des Spiels erlernt werden können, ist ein ebensolcher Witz. Ein Trainer erklärt vor jeder der Übungen, was der Spieler machen soll, doch diese Anweisungen sind weder vertont noch animiert, sondern werden in langweiligen Textboxen präsentiert. Ein Trainer, der statt der Ballmaschine auf der anderen Platzseite steht und Instruktionen gibt, hätte für eine deutlich höhere Motivation gesorgt, die Akademie zu spielen.</p>
<p>Nachdem die Grundlagen des Spiels erläutert wurden, darf für die eigene Karriere ein Spieler zusammengestellt werden. Nachdem die äußeren Maße (Größe, Gewicht) und Details (Linkshänder, Art der Rückhand, Neigung zu Stöhnlauten) festgelegt wurden, dürfen die körperlichen Attribute (Kopfform, Haare, etc) sehr detailliert angepasst werden. Überraschenderweise gehören die Fertigkeiten (Vorhand, Rückhand, … - ingesamt acht Attribute) nicht zu diesen zu Beginn einzustellenden Spielereigenschaften, vielmehr starten alle Spieler mit denselben Attributen und können diese auch nicht mehr direkt beeinflussen.</p>
<p>Während der Karriere erhält man dann für jedes Spiel unterschiedliche Erfahrungspunkte, die bei entsprechender Anzahl in indirekte Steigerungen der Attribute gesteckt werden dürfen. Dazu wählt man einen von drei Spielstilen aus (offensiver o. defensiver Grundlinienspieler, Serve-and-Volley-Spezialist) und das Spiel verteilt davon abhängig Punkte auf die Attribute. Da die Auswirkungen einer Steigerung vorher angezeigt werden, ist der Spieler in einem bestimmten Rahmen immer noch an die eigenen Bedürfnissen anpassbar, oftmals muss man aber Kompromisse eingehen. Diese werden durch das System der Trainer aufgewogen, die bestimmte Anforderungen an den Spieler stellen (z.B. Schlage 50 Grundlinien-Winner) und dafür Bonuspunkte auf einzelne Attribute geben. Zudem gibt es viermal im Laufe der eigenen Karriere Bonuspunkte, die man entweder gleichmäßig auf Vor- und Rückhand verteilen kann oder nur einer der beiden Seiten zuteilt.</p>
<p>Dieses leicht an Rollenspiele erinnernde System der EP ist anfangs motivierend, hat aber auch seine Schattenseiten. So haben die Bonusattribute der Trainer der höchsten Stufe einen so großen Einfluss, dass ein Trainerwechsel deutliche Auswirkungen auf das eigene Spiel hat, da die neuen Fähigkeiten erst aufwendig erkämpft werden müssen und man bis dahin ohne sie auskommen muss. Zudem ist nach 20 Stilsteigerungen Schluss, und ab diesem Zeitpunkt sammelt man EPs ohne jeden Sinn.</p>
<p>Noch zweifelhafter sind die verschiedenen Status, die ein Spieler durchlaufen muss (Neues Talent, Jungspund, Jungstar, Star, Superstar, Legende). Denn als Greenhorn auf der Tour darf man nicht einfach an Grand-Slam-Turnieren teilnehmen, obwohl die eigene Spielstärke dies eigentlich erlauben würde. Es reicht auch nicht, genügend Punkte in der Weltrangliste erreicht zu haben. Nein, man muss die teilweise fragwürdigen Ziele erreichen, die mit einem Status verbunden sind - und wenn man schneller lernt, als das Spiel es vorsieht, dann versauert man trotzdem weiter auf kleinen Turnieren, bis die oft in Fleißarbeit ausartenden Ziele (z.B. Gewinne X Fans) erreicht wurden. Sind dann schließlich alle Ziele erreicht, fehlt es irgendwie auch an Herausforderungen, um die Karriere weiterzuspielen.</p>
<p>Mir persönlich fehlten auch über die Alibistatistiken hinausgehende Auswertungen. So wird zwar nach jedem Spiel eine Übersicht über erste Aufschläge, Punkte und Winner angezeigt, aber schon allein die Aufteilung auf die einzelnen Sätze ist nicht möglich. Hat man ein Jahr auf der Tour zu Ende gespielt, ist im Menü nicht mehr ersichtlich, welche Turniere mit welchem Ergebnis im Vorjahr gespielt wurden. Erst wenn man sich für ein Turnier entschieden hat und daran teilnimmt, sieht man zumindest das letzte Ergebnis bei diesem Turnier. Desweiteren gibt es zwar Statistiken über die eigenen Aufschläge und Punkteverteilungen, aber diese sind meist relativ nutzlos oder schlicht nicht ausführlich genug.</p>
<p>In Sachen Beschleunigung einer Tennispartie gegenüber der Realität (man denke nur an Sätze von Rafael Nadal, die länger als eine Stunde dauern) hat <em>Top Spin 4</em> mächtig zugelegt, aber ein gewonnes Grand-Slam-Turnier kann trotzdem noch eine Stunde dauern. Der Standardmodus sind dabei zwei Sätze bis 3 (statt 6 Spielen) mit fünf Runden, bei Mastersturnieren ist es nur ein Satz in jeder der vier Runden und bei Majors und Minors besteht ein Spiel nur aus einem Super-Tiebreak bis 11 und nach drei Runden ist das Turnier vorbei. Dadurch geht das erste Jahr der Karriere schnell vorbei, da ein Jahr nur aus 12 Monaten bzw Turnierslots besteht. Vor jedem Turnier darf darüberhinaus noch eine Trainingssession oder ein Spezialevent gespielt werden. Spezialevents sind Spiele für die in <em>Top Spin 4</em> vertretenen Tennismarken, Spiele gegen die ehemaligen Weltklassespieler oder kleinere Events, die zu mehr EP oder Fans führen. Gut gefallen hat mir, dass es nach einem ausgespielten Punkt schnell weitergeht mit dem nächsten Ballwechsel. Da haben mich die Vorgänger sehr genervt mit dieser Art der künstlichen Spielverlängerung.</p>
<p>Neben den schon erwähnten Turniertypen gibt es auch “internationale” Events (als wären andere Turniere nicht international), die abwechselnd entweder der World Cup oder ein Europe oder American Cup sind, je nach Nationalität des eigenen Spielers. Am Jahresende folgen schließlich die Barclays World Tour Finals, die im Gruppenmodus nur den besten acht Spielern der Jahresrangliste offen stehen. Alles in allem wurde also der Tenniszirkus mit für die Spielbarkeit sinnvollen Einschränkungen umgesetzt. Doppel kann man leider während der Karriere nicht spielen - eine zweite Weltrangliste oder gar eine Fokussierung auf das Spiel zu Zweit wäre sicherlich interessant gewesen.</p>
<p>Aufgefallen ist mir zudem, dass trotz der einstellbaren Schwierigkeit die Top-Spieler in verschiedenen Turniertypen unterschiedlich stark spielen. Schlägt man sie bei den Masters noch problemlos, können sie bei den Grand Slams zu echten Problemen werden. Ein wenig mehr Feinschliff hätte da nicht geschadet, da es zwischen Federer, Nadal, Djokovic und dem Rest des Feldes deutliche Unterschiede gibt und es somit nicht so homogen ist wie in der Realität. Zudem sind die Spiele zwar oft eng, aber selten kommt es zu anderen Ergebnissen als 0:3 oder 3:0.</p>
<p>Was bleibt ist das realistischste Tennisspiel, welches momentan verfügbar ist. Die Grafik auf dem Platz überzeugt, das Gameplay und die Steuerung sind so gut wie noch nie und die Darstellung des Tenniszirkus mit seinem Jahresablauf ist nah dran an der ATP-Tour. In Sachen Präsentation und Ladezeiten ist jedoch noch viel Verbesserungspotential vorhanden und ich würde mich über mehr bekannte Namen als die 17 aktuellen Spieler und 8 Legenden freuen - vor allem bei den Frauen.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>